package com.aspire.mirror.ops.api.domain.vulnerability;

import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.Data;

import java.util.List;
import java.util.Map;

/**
 * @projectName: OpsVulnerabilityInstanceQueryModel
 * @description: 漏洞实例查询请求实体
 * @author: luowenbo
 * @create: 2020-07-09 13:43
 **/
@Data
public class OpsVulnerabilityInstanceQueryModel {

    private String scanCycle;
    private String poolName;
    private String hostIp;
    private String vulnerabilityId;
    private String status;
    private String reportTime;
    private String department1;
    private String department2;
    private String bizSystem;
    private String osType;
    private String riskLevel;
    private String groupId;
    private String historyFlag;
    private String isFixed;
    private String id;
    private String      protocol;
    private String      service;

    private Map<String, List<String>> resFilterMap;
    /**
     *漏洞名称
     */
    private String name;

    @JsonProperty("pageNo")
    private Integer pageNo;

    @JsonProperty("pageSize")
    private Integer pageSize;

    public Integer getStartIdx() {
        if (pageSize == null) {
            return null;
        }
        return (pageNo == null || pageNo <= 0 ? 0 : pageNo - 1) * pageSize;
    }
}
