package com.aspire.mirror.ops.api.domain.vulnerability;

import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.Data;
import org.apache.commons.lang3.StringUtils;

import java.util.List;

/**
 * @projectName: OpsVulnerabilityQueryModel
 * @description: 漏洞查询请求实体类
 * @author: luowenbo
 * @create: 2020-07-08 17:05
 **/
@Data
public class OpsVulnerabilityQueryModel {

    private String      port;
    private String      protocol;
    private String      service;
    private String      name;
    private String      riskLevel;
    private String      cveNumber;
    private String      cncveNumber;
    private String      cnvdNumber;
    private String      cnnvdNumber;
    private String      describe;
    private String      repairMethod;
    private List<Long>  pipelineIdList;
    private List<Long>  goBackPipelineIdList;
    private String      softDependencies;
    private String      needReboot;
    private String      canFixed;
    private String      isFixed;
    private String      remark;
    private String      groupId;
    private String      department1;
    private String      department2;
    private String      bizSystem;
    private String      osType;
    private String      hostIp;
    private String      poolName;
    private String      scanCycle;
    private String id;
    @JsonProperty("pageNo")
    private Integer pageNo;

    @JsonProperty("pageSize")
    private Integer pageSize;

    private String orderColumn;
    private String orderType;
    public Integer getStartIdx() {
        if (pageSize == null) {
            return null;
        }
        return (pageNo == null || pageNo <= 0 ? 0 : pageNo - 1) * pageSize;
    }

    public String getPipelineIdListText() {
        return pipelineIdList == null ? null : StringUtils.join(pipelineIdList, ",");
    }

    public String getGoBackPipelineIdListText() {
        return goBackPipelineIdList == null ? null : StringUtils.join(goBackPipelineIdList, ",");
    }
}
