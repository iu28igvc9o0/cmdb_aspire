package com.migu.tsg.microservice.atomicservice.composite.clientservice.opsmanage;

import com.aspire.mirror.ops.api.domain.GeneralResponse;
import com.aspire.mirror.ops.api.domain.PageListQueryResult;
import com.aspire.mirror.ops.api.domain.vulnerability.*;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiResponse;
import io.swagger.annotations.ApiResponses;
import org.springframework.cloud.netflix.feign.FeignClient;
import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.*;

import java.util.List;
import java.util.Map;

/**
 * @projectName: VulnerabilityClient
 * @description: 接口
 * @author: luowenbo
 * @create: 2020-07-09 15:54
 **/
@FeignClient("OPS-SERVICE")
public interface VulnerabilityClient {
    @PostMapping(value = "/v1/ops-service/vulnerability/queryVulnerabilityList", produces = MediaType.APPLICATION_JSON_VALUE)
    PageListQueryResult<OpsVulnerability> queryVulnerabilityList(@RequestBody OpsVulnerabilityQueryModel queryParam);

    @GetMapping(value = "/v1/ops-service/vulnerability/queryVulnerabilityById", produces = MediaType.APPLICATION_JSON_VALUE)
    OpsVulnerability getVulnerabilityById(@RequestParam("vulnerabilityId") String vulId);

    @PutMapping(value = "/v1/ops-service/vulnerability/updateVulnerability", produces = MediaType.APPLICATION_JSON_VALUE)
    GeneralResponse updateVulnerability(@RequestBody OpsVulnerability vul);

    @GetMapping(value = "/v1/ops-service/vulnerability/riskLevelList", produces = MediaType.APPLICATION_JSON_VALUE)
    List<Object> getRiskLevelList();

    @PostMapping(value = "/v1/ops-service/vulnerability/queryVulInstanceList", produces = MediaType.APPLICATION_JSON_VALUE)
    PageListQueryResult<OpsVulnerabilityInstance> queryVulnerabilityInstanceList(@RequestBody OpsVulnerabilityInstanceQueryModel queryParam);

    @PutMapping(value = "/v1/ops-service/vulnerability/updateVulInstance", produces = MediaType.APPLICATION_JSON_VALUE)
    GeneralResponse updateVulInstance(@RequestBody OpsVulnerabilityInstance vulInstance);

    @PostMapping(value = "/v1/ops-service/vulnerability//saveVulnerability", produces = MediaType.APPLICATION_JSON_VALUE)
    GeneralResponse saveVulnerability(@RequestBody OpsVulnerability vul);

    @PutMapping(value = "/v1/ops-service/vulnerability/executeVulnerabilityRepair/{vulInstanceId}/{pipelineId}/{operateType}", produces = MediaType.APPLICATION_JSON_VALUE)
    GeneralResponse executeVulnerabilityRepair(@PathVariable("vulInstanceId") Long vulInstanceId,
                                               @PathVariable("pipelineId") Long pipelineId, @PathVariable("operateType") String operateType);

    @PostMapping(value = "/v1/ops-service/vulnerability/addBatchVulnerability", produces = MediaType.APPLICATION_JSON_VALUE)
    Map<String, Integer> addBatchVulnerability(@RequestBody BatchVulnerabilityRequest batchVulnerabilityRequest);

    @PostMapping(value = "/v1/ops-service/vulnerability/saveVulnerabilityInstance", produces = MediaType.APPLICATION_JSON_VALUE)
    GeneralResponse saveVulnerabilityInstance(@RequestBody OpsVulnerabilityInstance vul);

    @PostMapping(value = "/v1/ops-service/vulnerability/vulnerabilityReport", produces = MediaType.APPLICATION_JSON_VALUE)
    List<OpsVulnerabilityReportItem> vulnerabilityReport(@RequestBody OpsVulnerabilityReportQuery queryParam);

    @GetMapping(value = "/v1/ops-service/vulnerability/loadPoolCodeNameMapList", produces = MediaType.APPLICATION_JSON_VALUE)
    List<OpsVulPoolCodeNameMap> loadPoolCodeNameMapList();

    @GetMapping(value = "/v1/ops-service/vulnerability/getScanCycleList", produces = MediaType.APPLICATION_JSON_VALUE)
    List<OpsVulScanCycle> getScanCycleList();

    @GetMapping(value = "/v1/ops-service/vulnerability/getVulnerabilityInstanceDetailById", produces = MediaType.APPLICATION_JSON_VALUE)
    OpsVulnerabilityInstanceDetail getVulnerabilityInstanceDetailById(@RequestParam("vulInstanceId") Long vulInstanceId);

    @PutMapping(value = "/v1/ops-service/vulnerability/batchExecuteVulnerabilityRepair", produces = MediaType.APPLICATION_JSON_VALUE)
    GeneralResponse batchExecuteVulnerabilityRepair(@RequestBody BatchExecuteVulnerabilityReqModel execVulModel);

    @PostMapping(value = "/v1/ops-service/vulnerability/saveVulScanCycle", produces = MediaType.APPLICATION_JSON_VALUE)
    GeneralResponse saveVulScanCycle(@RequestBody OpsVulScanCycle opsVulScanCycle);

    @PostMapping(value = "/v1/ops-service/vulnerability/queryVulReportDetailStatistics", produces = MediaType.APPLICATION_JSON_VALUE)
    List<VulReportDetailStatistics> queryVulReportDetailStatistics(@RequestBody OpsVulNewReportQuery queryParam);

    @PostMapping(value = "/v1/ops-service/vulnerability/queryVulReportItemList", produces = MediaType.APPLICATION_JSON_VALUE)
    PageListQueryResult<VulReportDetailItem> queryVulReportItemList(@RequestBody OpsVulNewReportQuery queryParam);

    @PostMapping(value = "/v1/ops-service/vulnerability/vulNewReport", produces = MediaType.APPLICATION_JSON_VALUE)
    PageListQueryResult<OpsVulnerabilityNewReportItem> vulNewReport(@RequestBody OpsVulNewReportQuery queryParam);
}
