package com.migu.tsg.microservice.atomicservice.composite.controller.handler;

import cn.afterturn.easypoi.handler.impl.ExcelDataHandlerDefaultImpl;
import com.aspire.mirror.ops.api.domain.RiskLevelEnum;
import com.aspire.mirror.ops.api.domain.vulnerability.OpsVulnerability;
import com.migu.tsg.microservice.atomicservice.composite.clientservice.opsmanage.VulnerabilityClient;
import groovy.util.logging.Slf4j;
import org.apache.commons.lang.StringUtils;
import org.springframework.stereotype.Component;

@Component
@Slf4j
public class VulnerabilityExcelHandler extends ExcelDataHandlerDefaultImpl<OpsVulnerability> {
    private final VulnerabilityClient vulnerabilityClient;
    public VulnerabilityExcelHandler(VulnerabilityClient vulnerabilityClient) {
        this.vulnerabilityClient = vulnerabilityClient;
    }

    @Override
    public Object importHandler(OpsVulnerability vul, String name, Object value) {
        if (name.equals("风险等级") && !StringUtils.isEmpty((String) value)) {
            value = RiskLevelEnum.fromLabel((String)value).getStatusCode();
        }
        return super.importHandler(vul, name, value);
    }
}
